---
title: 'I Should Have Majored in Excel'
author: Matt Farrow
date: "November 13, 2019"
output:
  xaringan::moon_reader:
  lib_dir: libs
  nature:
    highlightStyle: github
    highlightLines: true
    countIncrementalSlides: false
---

class: middle, center

background-color: #053C5E

## [haven't we been here before?](https://mattfarrow1.github.io/apra-doing-more-with-excel/slides#1)

.pull-left[

### <font color=white>2017 Talk Included:

- VLOOKUP
- CONCAT
- DATEDIF
- YEAR
- RAND
- Macros
- Pivot Tables

And more!

</font>

]

.pull-right[
  
<div style="width:75%;height:0;padding-bottom:100%;position:relative;"><iframe src="https://giphy.com/embed/l378xfLmpwfnkeIrm" width="75%" height="75%" style="position:absolute" frameBorder="0" class="giphy-embed" allowFullScreen></iframe></div><p><a href="https://giphy.com/gifs/HallmarkChannel-cute-lovestruckcafe-l378xfLmpwfnkeIrm"></a></p>

.right[<font color=#A31621>*Giphy*</font>]

]

---

class: center, middle, inverse

## <blockquote class="twitter-tweet" data-theme="light"><p lang="en" dir="ltr">What <a href="https://twitter.com/hashtag/Excel?src=hash&amp;ref_src=twsrc%5Etfw">#Excel</a> function/formula are you most proud of mastering?</p>&mdash; Microsoft Excel (@msexcel) <a href="https://twitter.com/msexcel/status/1187369905290649600?ref_src=twsrc%5Etfw">October 24, 2019</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

---

class: center, middle, inverse

# VLOOKUP

# Pivot Tables

# INDEX + MATCH

---

class: center, middle

## New leadership is staffing a regional team and you want to set them up for success.

![dilbert](https://assets.amuniversal.com/9c8f3f909160012ee3c400163e41dd5b)

.right[[Dilbert by Scott Adams](https://dilbert.com/strip/2011-08-17)]

---

# What is a pivot table?

> A PivotTable is a powerful tool to calculate, summarize, and analyze data that lets you see comparisons, patterns, and trends in your data.

.right[*[Microsoft](https://support.office.com/en-us/article/create-a-pivottable-to-analyze-worksheet-data-a9a84538-bfe9-40a9-a8e9-f99134456576#OfficeVersion=Windows)*]

.center[![](https://media.giphy.com/media/4ZodeEffXWzfBs0aWG/source.mp4)]

---

class: center, middle, inverse

# Where does the data fight us?

--

### To present less data, we must first create more data.

???

Present too much data and users will get lost in the weeds and not see the forest for the trees.

- Constituency
- Ratings
- States
- Giving

---

# VLOOKUP

> Use VLOOKUP when you need to find things in a table or a range by row. For example, look up a price of an automotive part by the part number, or find an employee name based on their employee ID.

.right[*[Microsoft](https://support.office.com/en-us/article/vlookup-function-0bbc8083-26fe-4963-8ab8-93a18ad188a1)*]

.center[=VLOOKUP(<font color="red">A1</font>, <font color="blue">Lookup!A1:B7</font>, <font color="orange">2</font>, <font color="green">TRUE</font>)]

=**VLOOKUP**(
- <font color="red">Value to look up</font>, 
- <font color="blue">Range to look for value</font>, 
- <font color="orange">Column for the return value</font>, 
- <font color="green">Type of match</font>)

???

Buckets for:

- Constituency
- Rating
- Region
- Giving

---

# Constituency

```{r constituency, echo = FALSE}
constituency <- tibble::tribble(
  ~"Constituency",
                                "Alumni - Certificate",
                                "Alumni - Graduate",
                                "Alumni - Non-Degreed",
                                "Alumni - Undergraduate",
                                "Faculty",
                                "Faculty - Past",
                                "Friend",
                                "Non-Alum Spouse of Alumni",
                                "Parent - Current",
                                "Parent - Past",
                                "Staff",
                                "Staff - Past",
                                "Student"
)

kableExtra::kable_styling(knitr::kable(constituency), font_size = 18)
```

---

# Clean Constituency

```{r clean_constituency, echo = FALSE}
clean_constituency <- tibble::tribble(
  ~"Constituency", ~"Clean Constituency",
                                      "Alumni - Certificate", "Alumni",
                                      "Alumni - Graduate", "Alumni",
                                      "Alumni - Non-Degreed", "Friend",
                                      "Alumni - Undergraduate", "Alumni",
                                      "Faculty","Faculty/Staff",
                                      "Faculty - Past", "Friend",
                                      "Friend", "Friend",
                                      "Non-Alum Spouse of Alumni",
                                      "Parent - Current",
                                      "Parent - Past", "Friend",
                                      "Staff", "Faculty/Staff",
                                      "Staff - Past", "Friend",
                                      "Student", "Friend"
)

kableExtra::kable_styling(knitr::kable(clean_constituency), font_size = 18)
```

---

# absolute/relative references

.pull-left[

Relative references **can** move.

.center[`A1`]

Absolute references **can't** move.

.center[`$A$1`]

]

.pull-right[

```{r references, echo = FALSE}
references <- tibble::tribble(
~`$A$2`, ~`The column and the row do not change when copied.`,
"A$2","The row does not change when copied.",
"$A2","The column does not change when copied."
)

kableExtra::kable_styling(knitr::kable(references), font_size = 18)
```

]


---

# Ratings

```{r ratings, echo = FALSE}
ratings <- tibble::tribble(
  ~"Rating", 
                              "A - $2.5M to $5M",
                              "B - $1M to $2.5M",
                              "C - $500,000 to $1M",
                              "D - $250,000 to $499,999",
                              "E - $100,000 to $249,999",
                              "G - $50,000 to $99,999",
                              "H - $25,000 to $49,999",
                              "I - $10,000 to $24,999"
  )

kableExtra::kable_styling(knitr::kable(ratings), font_size = 18)
```

---

# Clean Ratings

```{r clean_ratings, echo = FALSE}
clean_ratings <- tibble::tribble(
  ~"Rating", ~"Rating Bucket",
                              "A - $2.5M to $5M",	"PG",
                              "B - $1M to $2.5M",	"PG",
                              "C - $500,000 to $1M", "MG",
                              "D - $250,000 to $499,999",	"MG",
                              "E - $100,000 to $249,999",	"MG",
                              "G - $50,000 to $99,999",	"LG",
                              "H - $25,000 to $49,999",	"LG",
                              "I - $10,000 to $24,999",	"LG"
)

kableExtra::kable_styling(knitr::kable(clean_ratings), font_size = 18)
```

???

What buckets of prospects make the most sense for your organization?

---

# Region

Table & formula

---

# Giving

```{r clean_giving, echo = FALSE}

options(scipen = 999999)

clean_giving <- tibble::tribble(
  ~"Gift Amount", ~"Gift Bucket",
                              1,	"Less than $1,000",
                              1000,	"$1,000 to $9,999",
                              10000, "$10,000 to $99,999",
                              100000,	"$100,000 to $999,999",
                              1000000,	"$1,000,000+"
)

kableExtra::kable_styling(knitr::kable(clean_giving), font_size = 18)
```

???

**When we write the VLOOKUP formula for giving, what is going to be different?**
What we're matching isn't going to be exact. We're going for a "Price is Right" model - closest without going over.

---
# Pivot Table Summary

Clean up.
Multiple per page.

---

class: center, middle, inverse

# Questions?

## Matt Farrow

### [Formalized Curiosity](https://formalizedcuriosity.net)

---